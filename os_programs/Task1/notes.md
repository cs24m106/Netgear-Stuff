## IPC using Message Queues
Inter-Process Communication (IPC) is a method for communication within processes to exchange data, control information, or synchronizing tasks. There are various methods available for inter-process communication (IPC), like IPC using shared memory, message passing, semaphores, sockets, and message queues.

Reference: https://www.geeksforgeeks.org/operating-systems/ipc-using-message-queues/

Keypoints:
- linked list of messages stored within the kernel
- send and receive messages between processes in a first-in-first-out (FIFO) manner
- `msgget()`: create a new queue or open an existing queue
- `msgsnd()`: new messages are added to the end of a queue
- Note: every message has a positive long integer type field: corresponding to the non-negative length which are specified to  send call
- `msgrcv()`: messages are fetched from a queue
- Note: We don't have to fetch the messages in a first-in, first-out order. Instead, we can fetch messages based on their type field.
- need for msg_ques: enables asynchronous communication, where messages are placed in a queue and retrieved by processes in a convenient manner.

### Various System Calls fns

```c
PROTOTYPE: int msgctl ( int msgqid, int cmd, struct msqid_ds *buf );
RETURNS: 0 on success
        -1 on error : updates errno accordingly
COMMMANDS: IPC_STAT, IPC_SET, IPC_RMID
```
- IPC_RMID: Removes the queue from the kernel.
- The kernel maintains an instance of this structure for each queue which exists in the system. 
- By using the IPC_STAT command, we can retrieve a copy of this structure for examination.
- if errno: EINVAL  => msgqid invalid, or msgsz less than 0

```c
PROTOTYPE: int msgget(key_t key, int msgflg);
RETURNS: int 'msqid' (non negative) which is the message queue identifier
         -1 on error : updates errno accordingly

key_t key:  A unique integer value (often generated by the ftok() function) that identifies the message queue.
            Using the special value IPC_PRIVATE guarantees the creation of a new, unique message queue.
int msgflg: An integer that specifies both the access permissions and "control flags" typically combined (using the bitwise OR operator |)
            (e.g., IPC_CREAT, IPC_EXCL) for the queue. 

```
- **Accessing an existing queue:** 
    - If IPC_CREAT is not specified, 
    - msgget() returns the identifier for an existing queue associated with the given key, 
    - provided the process has the necessary permissions.
- **Creating a new queue:** 
    - A new message queue is created if the key is IPC_PRIVATE, 
    - or if the key doesn't exist and IPC_CREAT is specified in msgflg.
- **Permissions:** 
    - The low-order 9 bits of msgflg define the permissions for the queue, 
    - similar to file permissions (e.g., 0666 for read/write access for user, group, and others).
- **IPC_EXCL:** (exclusive)
    - When used with IPC_CREAT (e.g., IPC_CREAT | IPC_EXCL), 
    - it forces msgget() to fail if a message queue with the specified key already exists. 
    - This prevents a process from unintentionally using an existing queue. 

#### Common Permission Combinations:
- `0600` or `(S_IRUSR | S_IWUSR)`: Owner has read and write access, no one else has any access.
- `0660` or `(S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP)`: Owner and group have read and write access; others have no access.
- `0666` or `(S_IRWXU | S_IRWXG | S_IRWXO without execute bits)`, or `(all read/write bits OR'd together)`: Everyone has read and write access. 

|Constant 	|Description	|Octal Value|
|---|---|---|
|S_IRUSR	|Read permission for the owner (user)	|0400|
|S_IWUSR	|Write permission for the owner (user)	|0200|
|S_IRGRP	|Read permission for the group	|0040|
|S_IWGRP	|Write permission for the group	|0020|
|S_IROTH	|Read permission for others	|0004|
|S_IWOTH	|Write permission for others	|0002|


## Create Random test files

Linux users: Arbitrarily large text files can be generated on Linux with the following command:
```c
tr -dc "A-Za-z 0-9" < /dev/urandom | fold -w100|head -n 100000 > bigfile.txt
```
Reference: https://stackoverflow.com/questions/44492576/looking-for-large-text-files-for-testing-compression-in-all-sizes
